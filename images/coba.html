<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>SMECHAMART</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">

  <style>
    @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap');
    body{margin:0;font-family:'Poppins',sans-serif;background:#f9fafb;color:#333;}

    /* --- Slideshow Welcome --- */
    #welcome{position:relative;height:100vh;overflow:hidden;}
    .slides{position:absolute;top:0;left:0;width:100%;height:100%;}
    .slide{position:absolute;width:100%;height:100%;background-size:cover;background-position:center;opacity:0;transition:opacity 0.6s ease;display:flex;justify-content:center;align-items:center;}
    .slide.active{opacity:1;}
    .caption{background:rgba(0,0,0,0.6);padding:20px 30px;border-radius:10px;text-align:center;color:white;max-width:700px;}
    .caption h1{font-size:28px;margin-bottom:10px;display:flex;align-items:center;justify-content:center;gap:10px;}
    .caption p{font-size:18px;margin-bottom:15px;}
    .bt_main{display:inline-block;background:#ff9800;color:#fff;padding:10px 20px;border-radius:6px;border:none;font-weight:bold;cursor:pointer;transition:0.3s;}
    .bt_main:hover{background:#e68900;}
    .prev,.next{cursor:pointer;position:absolute;top:50%;padding:12px;color:white;font-weight:bold;font-size:22px;border-radius:50%;background:rgba(0,0,0,0.5);user-select:none;transition:0.3s;}
    .next{right:20px;}
    .prev{left:20px;}
    .prev:hover,.next:hover{background:rgba(0,0,0,0.8);}

    /* --- Bagian Belanja --- */
    #belanja{display:none;opacity:0;transform:translateY(30px);transition:opacity 0.6s ease,transform 0.6s ease;}
    #belanja.show{display:block;opacity:1;transform:translateY(0);}
    header{background:linear-gradient(135deg,#2e7d32,#1b5e20);color:white;text-align:center;padding:20px;box-shadow:0 3px 8px rgba(0,0,0,0.2);}
    header h1{margin:0;font-size:28px;display:flex;align-items:center;justify-content:center;gap:10px;}
    header img{width:45px;height:45px;}
    nav{display:flex;justify-content:space-between;align-items:center;background:linear-gradient(135deg,#ced7e0,#698679);padding:12px;flex-wrap:wrap;position:relative;box-shadow:0 2px 6px rgba(0,0,0,0.2);}
    .nav-left{cursor:pointer;font-weight:bold;color:#333;}

    /* Produk */
    .produk-list{display:grid;grid-template-columns:repeat(auto-fit,minmax(180px,1fr));gap:20px;padding:30px;max-width:1200px;margin:auto;}
    .produk{background:white;padding:15px;border-radius:15px;text-align:center;box-shadow:0 4px 12px rgba(0,0,0,0.1);transition:0.3s ease;position:relative;}
    .produk:hover{transform:translateY(-6px);box-shadow:0 6px 18px rgba(0,0,0,0.15);}
    .produk img{max-width:100%;border-radius:10px;margin-bottom:10px;}
    .pesan-btn, .keranjang-btn{display:inline-block;margin-top:10px;padding:8px 14px;background:#1ca523;color:white;border-radius:8px;cursor:pointer;font-size:14px;font-weight:600;transition:0.3s;margin-right:5px;}
    .pesan-btn:hover, .keranjang-btn:hover{background:#2db036;transform:scale(1.05);}

    /* Tentang, Galeri, Kontak, Kategori */
    #tentang,#galeri,#kontak,#kategori{display:none;padding:40px;max-width:900px;margin:auto;line-height:1.6;}
    #tentang h2,#galeri h2,#kontak h2,#kategori h2{text-align:center;margin-bottom:20px;}
    .btn-back{margin-top:20px;padding:10px 20px;background:#2e7d32;color:white;border:none;border-radius:8px;cursor:pointer;font-weight:600;}
    .btn-back:hover{background:#1b5e20;}


    /* Keranjang Utama */
     #cart{position:fixed;bottom:20px;right:20px;background:gold;padding:15px;border-radius:50%;font-size:22px;font-weight:bold;cursor:pointer;box-shadow:0 4px 10px rgba(0,0,0,0.2);z-index:1000;display:none;}
    #cart span{background:red;color:white;padding:2px 6px;border-radius:50%;font-size:14px;margin-left:5px;}
    #cart-panel{display:none;position:fixed;bottom:70px;right:20px;width:300px;background:white;border:1px solid #ccc;border-radius:10px;box-shadow:0 4px 12px rgba(0,0,0,0.2);padding:15px;z-index:1000;}
    #cart-panel h3{margin-top:0;}
    #cart-panel ul{list-style:none;padding:0;max-height:200px;overflow-y:auto;margin-bottom:10px;}
    #cart-panel ul li{padding:5px 0;border-bottom:1px solid #eee;display:flex;align-items:center;justify-content:space-between;}
    #cart-panel ul li img{width:30px;height:30px;border-radius:5px;margin-right:5px;}
    #cart-panel button{width:100%;padding:8px;background:#623960;color:white;border:none;border-radius:8px;font-weight:bold;cursor:pointer;}
    #cart-panel button:hover{background:#6c2e7d;}


    /* --- Galeri Slide Manual --- */
    .galeri-slide {position: relative;max-width: 800px;margin: 20px auto;border-radius: 15px;overflow: hidden;box-shadow: 0 6px 18px rgba(0,0,0,0.2);}
    .galeri-slide img {width: 100%;display: none;border-radius: 15px;}
    .galeri-slide img.active {display: block;}
    .galeri-btn {position: absolute;top: 50%;transform: translateY(-50%);background: rgba(0,0,0,0.5);color: white;border: none;padding: 12px;border-radius: 50%;cursor: pointer;transition: 0.3s;}
    .galeri-btn:hover {background: rgba(0,0,0,0.8);}
    .galeri-btn.prev {left: 15px;}
    .galeri-btn.next {right: 15px;}

    /* --- Daftar Pesanan --- */
    #daftar-pesanan{display:none;margin:20px auto;max-width:900px;}
    #daftar-pesanan table{width:100%;border-collapse:collapse;}
    #daftar-pesanan th, #daftar-pesanan td{border:1px solid #ccc;padding:8px;text-align:center;}
    #daftar-pesanan th{background:#2e7d32;color:white;}
    #daftar-pesanan input[type=number]{width:50px;}
    #daftar-pesanan button{padding:5px 10px;background:red;color:white;border:none;border-radius:5px;cursor:pointer;}
    #daftar-pesanan button:hover{background:#a50000;}
    #daftar-pesanan .checkout-btn{background:#2e7d32;color:white;margin-top:10px;padding:8px 20px;}
    #daftar-pesanan .checkout-btn:hover{background:#1b5e20;}
  

  .produk {
  background:white;
  padding:15px;
  border-radius:15px;
  text-align:center;
  box-shadow:0 4px 12px rgba(0,0,0,0.1);
  transition:0.3s ease;
  position:relative; /* penting untuk posisi absolut tombol */
}

.keranjang-btn {
  position: absolute; /* posisikan absolut relatif ke produk */
  top:10px;
  right:10px;
  display:inline-block;
  font-size:0; /* sembunyikan teks default, icon tetap terlihat */
  cursor:pointer;
  transition:0.3s;
}

.keranjang-btn i {
  font-size:20px;
  color:white;
  padding:8px;
  border-radius:8px;
  cursor:pointer;
  transition:0.3s;
}

.keranjang-btn i:hover {
  transform: scale(1.1);
}

/* Hapus margin yang tadinya di bawah tombol */
.pesan-btn {
  display:inline-block;
  margin-top:10px;
  padding:8px 14px;
  color:white;
  border-radius:8px;
  cursor:pointer;
  font-size:14px;
  font-weight:600;
  transition:0.3s;
}

/* --- Payment method + Admin styles (hidden by default) --- */
#payment-method{display:none;padding:20px;max-width:700px;margin:20px auto;background:#fff;border-radius:12px;box-shadow:0 4px 12px rgba(0,0,0,0.08);}
#admin{display:none;padding:20px;max-width:1000px;margin:20px auto;background:#fff;border-radius:12px;box-shadow:0 4px 12px rgba(0,0,0,0.08);}
#admin table{width:100%;border-collapse:collapse;}
#admin th{background:#2e7d32;color:white;padding:8px;}
#admin td{padding:8px;border:1px solid #eee;}

#kategori {
  display: none; /* disembunyikan di awal */
  padding:40px;
  max-width:900px;
  margin:auto;
  line-height:1.6;
}

  </style>
</head>
<body>

  <!-- Slideshow Welcome -->
  <section id="welcome">
    <div class="slides">
      <div class="slide active" style="background-image:url('minii.jpg')">
        <div class="caption">
          <h1>Selamat Datang di SMECHAMART</h1>
          <p>Selamat Datang di Koperasi Siswa SMECHAMART ‚Äì Tempat Belanja Murid, Murah & Nyaman</p>
        </div>
      </div>
      <div class="slide" style="background-image:url('ccc.jpg')">
        <div class="caption">
          <h1>Kami menyediakan berbagai kebutuhan siswa</h1>
          <p>Jajanan, Dessert, ATK</p>
        </div>
      </div>
      <div class="slide" style="background-image:url('brs3.jpg')">
        <div class="caption">
          <h1>Dikelola oleh siswa, untuk siswa</h1>
          <p>Belanja sambil belajar wirausaha</p>
          <button class="bt_main" onclick="showBelanja()">Belanja Sekarang</button>
        </div>
      </div>
    </div>
    <a class="prev" onclick="moveSlide(-1)">&#10094;</a>
    <a class="next" onclick="moveSlide(1)">&#10095;</a>
  </section>

  <!-- Belanja -->
  <section id="belanja">
    <header><h1><img src="cc.jpg" alt="logo"> SMECHAMART</h1><p>Belanja Hemat di Kopsis? Yuk ke Smechamart Online!</p></header>
    <nav>
      <div class="nav-left" onclick="showPage('tentang')">Tentang Kami</div>
      <div class="nav-left" onclick="showPage('galeri')">Galeri</div>
      <div class="nav-left" onclick="showKategori()">Belanja</div>
      <div class="nav-left" onclick="showPage('kontak')">Hubungi Kami</div>
    </nav>
<div id="belanja-banner" style="margin:20px auto;text-align:center;">
  <img src="minii.jpg" 
       alt="Banner Belanja" 
       style="max-width:100%;border-radius:12px;box-shadow:0 4px 12px rgba(0,0,0,0.2);">
</div>



    <div id="kategori">
      <h2>Pilih Kategori</h2>
      <div style="display:flex;gap:15px;justify-content:center;flex-wrap:wrap;">
        <button class="btn-back" onclick="renderProduk(jajanan,'jajanan')">Jajanan</button>
        <button class="btn-back" onclick="renderProduk(dessert,'dessert')">Dessert</button>
        <button class="btn-back" onclick="renderProduk(atk,'atk')">ATK</button>
      </div>
    </div>

    <div id="produk-list" class="produk-list"></div>

    <!-- Daftar Pesanan -->
    <div id="daftar-pesanan">
      <h2>Daftar Pesanan</h2>
      <table>
        <thead>
          <tr>
            <th>Nama Produk</th>
            <th>Harga</th>
            <th>Jumlah</th>
            <th>Total</th>
            <th>Ongkir</th>
            <th>Total Akhir</th>
            <th>Aksi</th>
          </tr>
        </thead>
        <tbody id="order-body"></tbody>
      </table>
      <button class="checkout-btn" onclick="checkoutPesanan()">Checkout</button>
    </div>

    <!-- Payment method (tampil setelah klik Checkout) -->
    <div id="payment-method" aria-hidden="true">
      <h2>Pilih Metode Pembayaran</h2>
      <p style="margin-bottom:8px;">Pilih metode pembayaran untuk menyelesaikan pesanan:</p>
      <div style="display:flex;gap:10px;flex-wrap:wrap;">
        <button class="btn-back" onclick="konfirmasiPembayaran('GoPay')">GoPay</button>
        <button class="btn-back" onclick="konfirmasiPembayaran('QRIS')">QRIS</button>
        <button class="btn-back" onclick="konfirmasiPembayaran('Tunai')">Tunai (COD)</button>
      </div>
      <p style="margin-top:12px;color:#666;font-size:14px;">(Ini simulasi ‚Äî untuk pembayaran nyata gunakan integrasi payment gateway)</p>
    </div>

    <!-- Tentang Kami -->
    <div id="tentang">
      <h2>Tentang Kami</h2>
      <p><b>SMECHAMART</b> adalah koperasi siswa SMKN 12 yang menyediakan berbagai kebutuhan siswa, mulai dari jajanan, minuman, hingga alat tulis sekolah. Kami hadir untuk mendukung kegiatan belajar sekaligus melatih jiwa wirausaha siswa.</p>
      <h3>Visi</h3>
      <p>Mewujudkan koperasi siswa yang mandiri, inovatif, dan bermanfaat bagi seluruh warga sekolah.</p>
      <h3>Misi</h3>
      <ul>
        <li>Menyediakan produk yang bermanfaat dengan harga terjangkau.</li>
        <li>Mengembangkan keterampilan kewirausahaan siswa.</li>
        <li>Menciptakan lingkungan belanja yang nyaman dan edukatif.</li>
      </ul>
      <button class="btn-back" onclick="showKategori()">Kembali</button>
    </div>

    <!-- Galeri -->
    <div id="galeri">
      <h2>Galeri</h2>

      <p>Suasana Kopsis</p>
      <div class="galeri-slide">
        <img src="minii.jpg" class="active" alt="Suasana 1">
        <img src="ddd.jpg" alt="Suasana 2">
        <img src="gg.jpg" alt="Suasana 3">
        <button class="galeri-btn prev" onclick="moveGaleriSlide(this,-1)">&#10094;</button>
        <button class="galeri-btn next" onclick="moveGaleriSlide(this,1)">&#10095;</button>
      </div>

      <p>Pelayanan Ramah</p>
      <div class="galeri-slide">
        <img src="ggg.jpg" class="active" alt="Pelayanan 1">
        <img src="jual.html.jpg" alt="Pelayanan 2">
        <img src="juall.html.jpg" alt="Pelayanan 3">
        <button class="galeri-btn prev" onclick="moveGaleriSlide(this,-1)">&#10094;</button>
        <button class="galeri-btn next" onclick="moveGaleriSlide(this,1)">&#10095;</button>
      </div>

      <p>Kegiatan Kopsis</p>
      <div class="galeri-slide">
        <img src="brs2.jpg" class="active" alt="Kegiatan 1">
        <img src="brs.jpg" alt="Kegiatan 2">
        <button class="galeri-btn prev" onclick="moveGaleriSlide(this,-1)">&#10094;</button>
        <button class="galeri-btn next" onclick="moveGaleriSlide(this,1)">&#10095;</button>
      </div>

      <button class="btn-back" onclick="showKategori()">Kembali</button>
    </div>

    <!-- Hubungi Kami -->
    <div id="kontak">
      <h2>Hubungi Kami</h2>
      <p>üìç Alamat: SMKN 12, Jalan Contoh No. 123, Kota Anda</p>
      <p>üìû Telepon/WA: <a href="https://wa.me/082338592886" target="_blank">082338592886</a></p>
      <p>üìß Email: smechamart@example.com</p>

      <div class="form-kontak" style="max-width:400px;margin:20px auto;background:#fff;padding:20px;border-radius:10px;box-shadow:0 2px 8px rgba(0,0,0,0.1);">
        <h3>Kirim Pesan via WhatsApp</h3>
        <form onsubmit="kirimWA(event)">
          <input type="text" id="nama" placeholder="Nama Anda" required
            style="width:100%;padding:10px;margin:8px 0;border:1px solid #ccc;border-radius:6px;font-family:'Poppins',sans-serif;">
          <textarea id="pesan" rows="4" placeholder="Tulis pesan..." required
            style="width:100%;padding:10px;margin:8px 0;border:1px solid #ccc;border-radius:6px;font-family:'Poppins',sans-serif;"></textarea>
          <button type="submit"
            style="background:#2e7d32;color:#fff;border:none;padding:10px 20px;border-radius:6px;cursor:pointer;font-weight:600;">
            Kirim ke WhatsApp
          </button>
        </form>
      </div>

      <button class="btn-back" onclick="showKategori()">Kembali</button>
    </div>
  </section>

  <!-- Keranjang -->
  <div id="cart" onclick="toggleCart()">üõí <span id="cart-count">0</span></div>
  <div id="cart-panel">
    <h3>Keranjang</h3>
    <ul id="cart-items"></ul>
    <ul id="cart-items"></ul>
<p style="text-align:right;margin-top:10px;">
  Total yang dicentang: Rp <span id="cart-total">0</span>
</p>
    <button onclick="checkoutCart()">Checkout</button>
  </div>

  <!-- Admin (riwayat transaksi) -->
  <div id="admin" aria-hidden="true">
    <h2>Riwayat Transaksi (Admin)</h2>
    <table>
      <thead>
        <tr>
          <th>Nama Produk</th>
          <th>Jumlah</th>
          <th>Total (Rp)</th>
          <th>Metode</th>
          <th>Tanggal</th>
        </tr>
      </thead>
      <tbody id="admin-body"></tbody>
    </table>
    <div style="text-align:center;margin-top:12px;">
      <button class="btn-back" onclick="showKategori()">Kembali</button>
    </div>
  </div>
  <script>
    // === Data Produk ===
    const jajanan = [
      {nama:"kacang atom", harga:2000, img:"kacang atom.jpg"},
      {nama:"piatos", harga:2000, img:"piatos.jpg"},
      {nama:"taro", harga:2000, img:"tro.jpg"},
      {nama:"chiki twist", harga:2000, img:"ciki twist.jpg"},
      {nama:"chiki ball", harga:2000, img:"ciki ball.jpg"},
      {nama:"mie soba", harga:1000, img:"soba.jpg"},
      {nama:"kue salju", harga:2000, img:"kue.jpg"},
      {nama:"time break", harga:2000, img:"time break.jpg"},
      {nama:"wafer chocolatos", harga:1000, img:"wafer ckltts.jpg"},
      {nama:"cundamani", harga:5000, img:"cundamani.jpg"},
      {nama:"corn", harga:2500, img:"jgung.jpg"},
      {nama:"roti dawo", harga:2500, img:"crs.jpg"},
      {nama:"apetito", harga:2000, img:"ape.jpg"},
      {nama:"nabati taro", harga:1000, img:"nbt.jpg"},
      {nama:"wafer roll gery", harga:1000, img:"gry.jpg"},
      {nama:"tyko crezz", harga:2000, img:"taiko.jpg"},
      {nama:"mie goreng spix", harga:1000, img:"spix.jpg"},
      {nama:"daya crezz", harga:2000, img:"dya.jpg"}
    ];
    const dessert= [
      {nama:"siomay", harga:5000, img:"111.jpg"},
      {nama:"sate tahu", harga:8000, img:"222.jpg"},
      {nama:"buah segar", harga:12000, img:"333.jpg"},
      {nama:"tusuk ayam krispi", harga:3000, img:"444.jpg"},
      {nama:"kebab", harga:5000, img:"5.jpg"},
      {nama:"brownis coklat", harga:4000, img:"6.jpg"},
      {nama:"martabak mini", harga:2000, img:"7.jpg"},
      {nama:"molen", harga:2000, img:"8.jpg"},
      {nama:"donat isi", harga:2000, img:"9.jpg"},
      {nama:"donat meses", harga:2000, img:"555.jpg"},
      {nama:"sosis bakar", harga:5000, img:"ssi.jpg"},
      {nama:"pentol goreng", harga:500, img:"jjj.jpg"}
    ];
    const atk = [
      {nama:"Buku Gambar", harga:4500, img:"BUKU GAMBAR.JPG"},
      {nama:"Buku Tulis", harga:3500, img:"TLS.JPG"},
      {nama:"Lem Kertas", harga:3000, img:"LEM KERTAS.JPG"},
      {nama:"Solasi Bening ", harga:1500, img:"SOLASI.JPG"},
      {nama:"Palet", harga:2000, img:"PALET.JPG"},
      {nama:"Cat Acrilic", harga:22000, img:"ACRILIC.JPG"},
      {nama:"Kuas", harga:3000, img:"KUAS.JPG"},
      {nama:"Blupoin", harga:2000, img:"STANDARD.JPG"},
      {nama:"Rautan", harga:2000, img:"RAUTAN.JPG"},
      {nama:"Pensil", harga:1500, img:"PENSIL.JPG"},
      {nama:"Spidol besar", harga:3000, img:"SPIDOL.JPG"},
      {nama:"Penghapus", harga:750, img:"PENGHAPUS.JPG"}
    ];

    // === Slide Welcome ===
    let currentSlide=0;
    function showSlide(i){document.querySelectorAll(".slide").forEach((s,idx)=>s.classList.toggle("active",idx===i));}
    function moveSlide(n){ const slides=document.querySelectorAll(".slide"); currentSlide=(currentSlide+n+slides.length)%slides.length; showSlide(currentSlide); }
    setInterval(()=>moveSlide(1),5000);

    // === Navigasi Halaman ===
   function showBelanja(){
  document.getElementById("welcome").style.display="none";
  document.getElementById("belanja").classList.add("show");
  document.getElementById("cart").style.display = "block";
  
  // tampilkan banner
  const banner = document.getElementById("belanja-banner");
  if(banner) banner.style.display = "block";
}

    function showKategori(){
      ['tentang','galeri','kontak'].forEach(p=>document.getElementById(p).style.display='none');
      document.getElementById("kategori").style.display='block';
      document.getElementById("produk-list").innerHTML = ""; // kosong, jangan langsung tampil produk
    }
    function showPage(page){
      // hide main sections except the requested one
      ['tentang','galeri','kontak','kategori','daftar-pesanan','payment-method','admin','produk-list'].forEach(p=>{ const el=document.getElementById(p); if(el) el.style.display='none'; });
      const el=document.getElementById(page);
      if(el) el.style.display='block';
      // sembunyikan banner
const banner = document.getElementById("belanja-banner");
if(banner) banner.style.display = "none";

    }

    // === Render Produk ===
    function renderProduk(data,kategori){
      const list=document.getElementById("produk-list");
      list.innerHTML="";
      data.forEach((p,idx)=>{
        const hargaNum = Number(p.harga) || 0;
        list.innerHTML+=`
          <div class="produk">
            <img src="${p.img}" alt="${p.nama}">
            <h3>${p.nama}</h3>
            <p>Rp ${hargaNum.toLocaleString()}</p>
            <div>
              <span class="keranjang-btn" onclick="addToCart('${kategori}',${idx})">
                <i class="bi bi-cart4"></i>
              </span>
              <span class="pesan-btn" onclick="tambahPesanan('${kategori}',${idx})">Pesan</span>
            </div>
          </div>`;
      });
      list.style.display="grid";
      // hide other pages
      ['tentang','galeri','kontak'].forEach(p=>{ const el=document.getElementById(p); if(el) el.style.display='none';});
      document.getElementById("produk-list").style.display='grid';
    }

    // === Keranjang (cart panel) ===
    let cart=[];
    function addToCart(kat,idx){
      const item={...(kat==="jajanan"?jajanan[idx]:kat==="dessert"?dessert[idx]:atk[idx])};
      const exist=cart.find(c=>c.nama===item.nama);
      if(exist){ exist.qty = (exist.qty||1) + 1; }
      else{ cart.push({...item,qty:1}); }
      updateCart();
    }
    function updateCart(){
  const count = cart.reduce((a,c)=>a+(c.qty||0),0);
  document.getElementById("cart-count").innerText = count;
  const ul=document.getElementById("cart-items");
  ul.innerHTML="";
  cart.forEach((c,i)=>{
    const hargaNum = Number(c.harga) || 0;
    ul.innerHTML+=`<li style="display:flex;align-items:center;justify-content:space-between;margin-bottom:6px;">
      <div style="display:flex;align-items:center;">
        <input type="checkbox" class="cart-checkbox" data-index="${i}" style="margin-right:6px;" checked onchange="hitungTotalCart()">
        <img src="${c.img}" style="width:40px;height:40px;border-radius:6px;object-fit:cover;margin-right:8px;">
        <div>
          <div style="font-weight:600">${c.nama}</div>
          <div style="font-size:13px;">${c.qty} x Rp ${hargaNum.toLocaleString()}</div>
        </div>
      </div>
      <div style="text-align:right;">
        <div><b>Rp ${(hargaNum*c.qty).toLocaleString()}</b></div>
        <div style="margin-top:6px;"><button onclick="hapusDariCart(${i})" style="padding:6px;border-radius:6px;border:none;background:#e53935;color:white;cursor:pointer;">Hapus</button></div>
      </div>
    </li>`;
  });
  if(cart.length===0) ul.innerHTML="<li>Keranjang kosong</li>";
  hitungTotalCart(); // update total
}

    function hapusDariCart(i){
      cart.splice(i,1); updateCart();
    }
    function toggleCart(){ const p=document.getElementById("cart-panel"); p.style.display = p.style.display==="block" ? "none" : "block"; }
function hitungTotalCart(){
  let total = 0;
  document.querySelectorAll(".cart-checkbox").forEach(cb=>{
    if(cb.checked){
      const idx = parseInt(cb.dataset.index);
      const item = cart[idx];
      total += (Number(item.harga) || 0) * (item.qty || 1);
    }
  });
  document.getElementById("cart-total").innerText = total.toLocaleString();
}
function checkoutCart(){ 
  const selected = [];
  document.querySelectorAll(".cart-checkbox").forEach(cb=>{
    if(cb.checked){
      const idx = parseInt(cb.dataset.index);
      selected.push({...cart[idx]});
    }
  });

  if(selected.length===0){ alert("Belum ada item yang dicentang!"); return; }

  pesanan = selected.map(c=>({nama:c.nama,harga:c.harga,jumlah:c.qty}));
  renderPesanan();
  toggleCart();
  showPage('daftar-pesanan');

  // hapus item yang dicentang dari cart
  cart = cart.filter((c,i)=>!selected.includes(c));
  updateCart();
}

    // === Galeri Manual ===
    function moveGaleriSlide(btn,dir){
      const slide=btn.parentElement;
      const imgs=slide.querySelectorAll("img");
      let idx=[...imgs].findIndex(i=>i.classList.contains("active"));
      if(idx<0) idx=0;
      imgs[idx].classList.remove("active");
      idx=(idx+dir+imgs.length)%imgs.length;
      imgs[idx].classList.add("active");
    }

    // === Form WA ===
    function kirimWA(e){
      e.preventDefault();
      let nama=document.getElementById("nama").value;
      let pesan=document.getElementById("pesan").value;
      let url=`https://wa.me/082338592886?text=Halo%20saya%20${encodeURIComponent(nama)}%2C%20${encodeURIComponent(pesan)}`;
      window.open(url,"_blank");
    }

    // === Daftar Pesanan ===
    let pesanan=[];
    function tambahPesanan(kat,idx){
      const item={...(kat==="jajanan"?jajanan[idx]:kat==="dessert"?dessert[idx]:atk[idx])};
      const exist=pesanan.find(p=>p.nama===item.nama);
      if(exist){ exist.jumlah = (exist.jumlah||1) + 1; }
      else{ pesanan.push({...item,jumlah:1}); }
      renderPesanan();
    }
    function renderPesanan(){
      document.getElementById("daftar-pesanan").style.display="block";
      const body=document.getElementById("order-body");
      body.innerHTML="";
      if(pesanan.length===0){ body.innerHTML="<tr><td colspan='7'>Belum ada pesanan</td></tr>"; return; }
      pesanan.forEach((p,i)=>{
        let hargaNum = Number(p.harga) || 0;
        let total = p.jumlah * hargaNum;
        let ongkir = 2000; // contoh ongkir flat
        let totalAkhir = total + ongkir;
        body.innerHTML+=`
          <tr>
            <td>${p.nama}</td>
            <td>Rp ${hargaNum.toLocaleString()}</td>
            <td><input type="number" min="1" value="${p.jumlah}" onchange="ubahJumlah(${i},this.value)"></td>
            <td>Rp ${total.toLocaleString()}</td>
            <td>Rp ${ongkir.toLocaleString()}</td>
            <td>Rp ${totalAkhir.toLocaleString()}</td>
            <td><button onclick="hapusPesanan(${i})">Hapus</button></td>
          </tr>`;
      });
    }
    function ubahJumlah(i,val){
      pesanan[i].jumlah = parseInt(val) || 1;
      renderPesanan();
    }
    function hapusPesanan(i){
      pesanan.splice(i,1);
      renderPesanan();
      if(pesanan.length===0){
        document.getElementById("daftar-pesanan").style.display="none";
      }
    }

    // === Riwayat Transaksi (Admin) ===
    let transaksi=[];

    // checkoutPesanan: tampilkan pilihan metode pembayaran (menggantikan alert)
    function checkoutPesanan(){
      if(!pesanan || pesanan.length===0){
        alert("Belum ada pesanan.");
        return;
      }
      document.getElementById("payment-method").style.display="block";
      document.getElementById("daftar-pesanan").style.display="none";
      // scroll ke payment-method
      document.getElementById("payment-method").scrollIntoView({behavior:'smooth'});
    }

    // konfirmasiPembayaran: simpan ke transaksi[] lalu render admin
    function konfirmasiPembayaran(metode){
      const tanggal = new Date().toLocaleString();
      pesanan.forEach(p => {
        const hargaNum = Number(p.harga) || 0;
        transaksi.push({
          nama: p.nama,
          jumlah: p.jumlah,
          total: hargaNum * p.jumlah + 2000, // termasuk contoh ongkir
          metode,
          tanggal
        });
      });
      alert("Pesanan berhasil dengan metode: " + metode);
      // reset pesanan & hide payment
      pesanan = [];
      document.getElementById("payment-method").style.display = "none";
      renderAdmin();
      showPage('admin');
      // also clear cart
      cart = [];
      updateCart();
    }

    function renderAdmin(){
      const body = document.getElementById("admin-body");
      body.innerHTML = "";
      if(transaksi.length===0){
        body.innerHTML = "<tr><td colspan='5'>Belum ada transaksi</td></tr>";
        return;
      }
      transaksi.forEach(t => {
        body.innerHTML += `
          <tr>
            <td>${t.nama}</td>
            <td>${t.jumlah}</td>
            <td>Rp ${t.total.toLocaleString()}</td>
            <td>${t.metode}</td>
            <td>${t.tanggal}</td>
          </tr>`;
      });
    }

    // === Cart -> Pesanan flow already handled in checkoutCart()

    // Initial UI state
    updateCart();

    // Accessibility: close payment method on Escape
    document.addEventListener('keydown', (e)=>{
      if(e.key === "Escape"){
        const pm=document.getElementById("payment-method");
        if(pm && pm.style.display === 'block') pm.style.display='none';
      }
    });

    // Initialize product list default (you can keep kategori hidden until user clicks Belanja)
    // but to make it convenient, render nothing until user chooses a category.
    // If you want to show all by default, call renderProduk([...], 'all') here.

    // Expose functions for buttons that exist in HTML but defined later
    window.showBelanja = showBelanja;
    window.showKategori = showKategori;
    window.showPage = showPage;
    window.renderProduk = renderProduk;
    window.addToCart = addToCart;
    window.tambahPesanan = tambahPesanan;
    window.checkoutPesanan = checkoutPesanan;
    window.konfirmasiPembayaran = konfirmasiPembayaran;
    window.checkoutCart = checkoutCart;
    window.toggleCart = toggleCart;
    window.kirimWA = kirimWA;
    window.hapusDariCart = hapusDariCart;
    window.hapusPesanan = hapusPesanan;
    window.ubahJumlah = ubahJumlah;

  </script>
</body>
</html>    